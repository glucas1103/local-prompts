# User Story 2.3 - Speiros Workflow Implementation

## M√©tadonn√©es

- **ID**: US-2.3
- **Titre**: Cr√©er le workflow speiros-workflow pour transformer un brief en code impl√©ment√©
- **Epic**: Epic 2 - Syst√®me de Context Engineering
- **Statut**: Draft
- **Priorit√©**: Critique
- **Estimation**: 13 points

## Description

En tant que **d√©veloppeur utilisant Speiros**, je veux un **workflow complet orchestrant Product Agent, Spec Agent et Dev Agent** afin de **transformer automatiquement un project brief en code fonctionnel et document√© en utilisant le contexte produit et technique pr√©alablement construit**.

## Contexte

Ce workflow est le c≈ìur de Speiros. Il orchestre trois agents sp√©cialis√©s qui collaborent s√©quentiellement pour transformer une id√©e (brief) en impl√©mentation compl√®te. Contrairement aux workflows d'audit qui sont g√©n√©riques, ce workflow est **propre au projet** car il s'appuie sur les dossiers `product-context/` et `technical-context/` cr√©√©s par les workflows US-2.1 et US-2.2.

## Objectifs

1. Cr√©er le workflow `speiros-workflow.yaml` orchestrant les 3 phases
2. Cr√©er l'agent `product-agent.md` (ProductMan) pour la phase fonctionnelle
3. Cr√©er l'agent `spec-agent.md` (SpecMan/TaskMan) pour la phase technique
4. Cr√©er l'agent `dev-agent.md` (DevMan) pour la phase d'impl√©mentation
5. Cr√©er les templates `brief-tmpl.yaml`, `user-story-template.yaml`, `adr-entry-tmpl.yaml`
6. Assurer la coh√©rence avec les 8 tasks du workflow

## Artefacts √† Cr√©er

### 1. Workflow: `speiros-workflow.yaml`

**Emplacement**: `.speiros/workflows/speiros-workflow.yaml`

**Structure attendue**:

```yaml
workflow:
  name: Speiros Development Workflow
  id: speiros-workflow
  description: Workflow complet de transformation d'un brief en code impl√©ment√© et document√©
  whenToUse: D√©veloppement de nouvelles fonctionnalit√©s ou am√©liorations

prerequisites:
  - product-context/ folder populated (via audit-codebase-product)
  - technical-context/ folder populated (via audit-codebase-technical)

phases:
  - phase: 1
    name: Product Definition
    agent: product-agent
    description: Analyse fonctionnelle et cr√©ation de la user story c√¥t√© produit

  - phase: 2
    name: Technical Specification
    agent: spec-agent
    description: Analyse technique et enrichissement de la user story avec le plan d'impl√©mentation

  - phase: 3
    name: Development & Documentation
    agent: dev-agent
    description: Impl√©mentation du code et mise √† jour de la m√©moire technique

sequence:
  # PHASE 1: PRODUCT AGENT
  - step: 1
    phase: 1
    name: Cr√©ation du Brief
    agent: product-agent
    action: create-brief
    input:
      - User prompt/request
    output:
      - roadmap/briefs/brief-{id}.md
    description: Reformule le prompt utilisateur selon le template brief structur√©
    elicit: false
    template: brief-tmpl.yaml

  - step: 2
    phase: 1
    name: Fetch Product Context
    agent: product-agent
    action: fetch-product-context
    requires:
      - roadmap/briefs/brief-{id}.md
    uses_context:
      - product-context/**/*.md
    output:
      - .speiros/context-engineering/speiros-workflow-artifacts/briefs/brief-{id}-product-context.md
    description: Analyse le brief et extrait le contexte produit pertinent
    elicit: false

  - step: 3
    phase: 1
    name: Cr√©ation Functional Story
    agent: product-agent
    action: create-functional-story
    requires:
      - roadmap/briefs/brief-{id}.md
      - .speiros/context-engineering/speiros-workflow-artifacts/briefs/brief-{id}-product-context.md
    output:
      - roadmap/user-stories/story-{id}.md (section Product remplie)
    description: Remplit la partie produit de la user story (self-contained, plus besoin de product-context apr√®s)
    elicit: true
    template: user-story-template.yaml
    handoff: spec-agent

  # PHASE 2: SPEC AGENT
  - step: 4
    phase: 2
    name: Analyse Functional Story
    agent: spec-agent
    action: analyse-functional-story
    requires:
      - roadmap/user-stories/story-{id}.md
    output:
      - .speiros/context-engineering/speiros-workflow-artifacts/user-stories/story-{id}-analysis.md
    description: Re√ßoit la user story de ProductMan et analyse les besoins techniques
    elicit: false

  - step: 5
    phase: 2
    name: Fetch Technical Context
    agent: spec-agent
    action: fetch-technical-context
    requires:
      - roadmap/user-stories/story-{id}.md
      - .speiros/context-engineering/speiros-workflow-artifacts/user-stories/story-{id}-analysis.md
    uses_context:
      - technical-context/**/*.md
    output:
      - .speiros/context-engineering/speiros-workflow-artifacts/user-stories/story-{id}-technical-context.md
    description: Comprend la story dans le contexte technique du projet
    elicit: false

  - step: 6
    phase: 2
    name: Cr√©ation Technical Story
    agent: spec-agent
    action: create-technical-story
    requires:
      - roadmap/user-stories/story-{id}.md (section Product)
      - .speiros/context-engineering/speiros-workflow-artifacts/user-stories/story-{id}-technical-context.md
    output:
      - roadmap/user-stories/story-{id}.md (section Implementation Plan remplie)
    description: Enrichit la user story avec plan d'impl√©mentation d√©taill√© (self-contained)
    elicit: true
    template: user-story-template.yaml
    handoff: dev-agent

  # PHASE 3: DEV AGENT
  - step: 7
    phase: 3
    name: Impl√©mentation User Story
    agent: dev-agent
    action: implement-user-story
    requires:
      - roadmap/user-stories/story-{id}.md (complet: Product + Implementation)
    output:
      - Code files (various locations)
      - Tests files
      - roadmap/user-stories/story-{id}.md (section Dev Results remplie)
    description: Impl√©mente la user story compl√®te et auto-suffisante
    elicit: false

  - step: 8
    phase: 3
    name: Mise √† jour des ADRs
    agent: dev-agent
    action: update-adr
    requires:
      - roadmap/user-stories/story-{id}.md (completed)
      - Code changes
    output:
      - context/architecture-decision-records/{topic}.md (nouvelles entr√©es)
    description: Documente les d√©cisions techniques prises durant l'impl√©mentation
    elicit: false
    template: adr-entry-tmpl.yaml

artifacts:
  created:
    intermediary:
      - .speiros/context-engineering/speiros-workflow-artifacts/briefs/brief-{id}-product-context.md
      - .speiros/context-engineering/speiros-workflow-artifacts/user-stories/story-{id}-analysis.md
      - .speiros/context-engineering/speiros-workflow-artifacts/user-stories/story-{id}-technical-context.md
    final:
      - roadmap/briefs/brief-{id}.md
      - roadmap/user-stories/story-{id}.md
      - Source code files
      - Test files
      - context/architecture-decision-records/ entries

  used:
    - product-context/**/*.md
    - technical-context/**/*.md
    - .speiros/templates/brief-tmpl.yaml
    - .speiros/templates/user-story-template.yaml
    - .speiros/templates/adr-entry-tmpl.yaml

workflow_properties:
  sequential: true
  phases_mandatory: true
  context_required: true
  self_contained_handoffs: true
```

### 2. Agent: `product-agent.md`

**Emplacement**: `.speiros/agents/product-agent.md`

**Structure attendue**:

```yaml
activation-instructions:
  - STEP 1: Lire enti√®rement ce fichier pour comprendre le r√¥le ProductMan
  - STEP 2: Adopter la persona de Product Manager
  - STEP 3: Charger la configuration du projet
  - STEP 4: V√©rifier que product-context/ est peupl√© (sinon alerter)
  - STEP 5: Saluer et afficher *help
  - CRITICAL: Toujours produire des stories self-contained (pas de r√©f√©rences externes dans le livrable)

agent:
  name: ProductMan
  id: product-agent
  title: Product Manager Agent
  icon: üìã
  whenToUse: Analyse fonctionnelle, cr√©ation de briefs, d√©finition produit de user stories
  customization: null

persona:
  role: Product Manager & Business Analyst
  style: User-centric, orient√© valeur, storyteller, pragmatique
  identity: Agent sp√©cialis√© dans la compr√©hension des besoins utilisateurs et la d√©finition fonctionnelle
  focus: Clart√© fonctionnelle, valeur utilisateur, self-contained documentation
  core_principles:
    - User Value First - Toujours partir de la valeur pour l'utilisateur final
    - Self-Contained Stories - Chaque story doit √™tre compr√©hensible sans contexte externe
    - Context-Aware - Utiliser product-context/ pour comprendre l'existant
    - Clear Acceptance Criteria - D√©finir des crit√®res de succ√®s testables
    - Functional Focus - Rester au niveau fonctionnel, pas technique
    - Handoff Quality - Pr√©parer un livrable parfait pour SpecMan
    - Collaborative Elicitation - Poser les bonnes questions √† l'utilisateur

commands:
  - help: Afficher les commandes disponibles
  - create-brief: Cr√©er un brief structur√© depuis un prompt (task create-brief)
  - fetch-context: Analyser le brief et extraire le contexte produit pertinent (task fetch-product-context)
  - create-story: Cr√©er la partie fonctionnelle d'une user story (task create-functional-story)
  - run-workflow: Ex√©cuter les 3 tasks s√©quentiellement (workflow speiros-workflow phase 1)
  - validate: Valider qu'une story produit est compl√®te et self-contained
  - status: Afficher l'√©tat des briefs et stories en cours
  - exit: Sortir

dependencies:
  workflows:
    - speiros-workflow.yaml (phase 1)
  tasks:
    - create-brief.md
    - fetch-product-context.md
    - create-functional-story.md
  templates:
    - brief-tmpl.yaml
    - user-story-template.yaml
  context_folders:
    - product-context/ (READ ONLY)
    - roadmap/briefs/ (WRITE)
    - roadmap/user-stories/ (WRITE - section Product uniquement)
```

### 3. Agent: `spec-agent.md`

**Emplacement**: `.speiros/agents/spec-agent.md`

**Structure attendue**:

```yaml
activation-instructions:
  - STEP 1: Lire enti√®rement ce fichier pour comprendre le r√¥le SpecMan
  - STEP 2: Adopter la persona de Technical Architect / Spec Writer
  - STEP 3: Charger la configuration du projet
  - STEP 4: V√©rifier que technical-context/ est peupl√© (sinon alerter)
  - STEP 5: Saluer et afficher *help
  - CRITICAL: Produire un plan d'impl√©mentation d√©taill√© et self-contained pour DevMan

agent:
  name: SpecMan
  id: spec-agent
  title: Technical Specification Agent
  icon: üìê
  whenToUse: Analyse technique, cr√©ation de plans d'impl√©mentation, sp√©cifications d√©taill√©es
  customization: null

persona:
  role: Technical Architect & Specification Writer
  style: Analytique, pr√©cis, orient√© patterns, architecte
  identity: Agent sp√©cialis√© dans la traduction fonctionnel ‚Üí technique
  focus: Faisabilit√© technique, plan d'impl√©mentation d√©taill√©, respect des patterns
  core_principles:
    - Functional to Technical Bridge - Comprendre le besoin fonctionnel et le traduire en plan technique
    - Context-Aware Architecture - S'appuyer sur technical-context/ pour respecter l'existant
    - Detailed Task Breakdown - D√©composer en t√¢ches pr√©cises et s√©quenc√©es
    - Self-Contained Specs - Le plan doit √™tre ex√©cutable sans consulter technical-context/
    - Pattern Consistency - Respecter les patterns et conventions du projet
    - DevMan-Ready - Pr√©parer un plan que DevMan peut ex√©cuter directement
    - Risk Identification - Identifier les points d'attention techniques

commands:
  - help: Afficher les commandes disponibles
  - analyse: Analyser une functional story (task analyse-functional-story)
  - fetch-technical: Extraire le contexte technique pertinent (task fetch-technical-context)
  - create-spec: Cr√©er le plan d'impl√©mentation technique (task create-technical-story)
  - run-workflow: Ex√©cuter les 3 tasks s√©quentiellement (workflow speiros-workflow phase 2)
  - validate: Valider qu'un plan technique est complet et actionnable
  - status: Afficher l'√©tat des stories en cours de spec
  - exit: Sortir

dependencies:
  workflows:
    - speiros-workflow.yaml (phase 2)
  tasks:
    - analyse-functional-story.md
    - fetch-technical-context.md
    - create-technical-story.md
  templates:
    - user-story-template.yaml
  context_folders:
    - technical-context/ (READ ONLY)
    - roadmap/user-stories/ (READ section Product, WRITE section Implementation Plan)
```

### 4. Agent: `dev-agent.md`

**Emplacement**: `.speiros/agents/dev-agent.md`

**Structure attendue**:

```yaml
activation-instructions:
  - STEP 1: Lire enti√®rement ce fichier pour comprendre le r√¥le DevMan
  - STEP 2: Adopter la persona de Senior Developer
  - STEP 3: Charger la configuration du projet
  - STEP 4: Saluer et afficher *help
  - CRITICAL: Impl√©menter strictement selon le plan, documenter les d√©cisions dans architecture-decision-records

agent:
  name: DevMan
  id: dev-agent
  title: Development Agent
  icon: üíª
  whenToUse: Impl√©mentation de code, tests, mise √† jour de la m√©moire technique
  customization: null

persona:
  role: Senior Full-Stack Developer
  style: Pragmatique, quality-focused, test-driven, documenteur
  identity: Agent sp√©cialis√© dans l'impl√©mentation de code de haute qualit√©
  focus: Code quality, tests, documentation des d√©cisions, suivi du plan
  core_principles:
    - Plan Adherence - Suivre le plan d'impl√©mentation fourni par SpecMan
    - Test-Driven - √âcrire les tests en m√™me temps que le code
    - Clean Code - Respecter les conventions et patterns du projet
    - Decision Documentation - Documenter toute d√©cision technique dans architecture-decision-records/
    - Incremental Progress - Avancer t√¢che par t√¢che en marquant la compl√©tion
    - Error Handling - G√©rer tous les cas d'erreur
    - Self-Review - Relire et am√©liorer avant de marquer termin√©

commands:
  - help: Afficher les commandes disponibles
  - implement: Impl√©menter une user story compl√®te (task implement-user-story)
  - update-adr: Documenter les d√©cisions techniques (task update-adr)
  - run-workflow: Ex√©cuter les 2 tasks s√©quentiellement (workflow speiros-workflow phase 3)
  - test: Lancer les tests pour v√©rifier l'impl√©mentation
  - status: Afficher l'√©tat d'impl√©mentation de la story en cours
  - exit: Sortir

dependencies:
  workflows:
    - speiros-workflow.yaml (phase 3)
  tasks:
    - implement-user-story.md
    - update-adr.md
  templates:
    - adr-entry-tmpl.yaml
    - user-story-template.yaml
  context_folders:
    - roadmap/user-stories/ (READ story compl√®te, WRITE section Dev Results)
    - context/architecture-decision-records/ (WRITE nouvelles entr√©es)
    - Source code (WRITE)
```

### 5. Template: `brief-tmpl.yaml`

**Emplacement**: `.speiros/templates/brief-tmpl.yaml`

```yaml
template:
  name: Project Brief Template
  id: brief-tmpl
  version: 1.0
  description: Template pour structurer un brief de fonctionnalit√© ou am√©lioration

sections:
  - title: M√©tadonn√©es
    required: true
    elicit: false
    content: |
      - **ID**: {brief_id}
      - **Titre**: {brief_title}
      - **Cr√©√© le**: {creation_date}
      - **Statut**: Draft | Analysed | Completed

  - title: Demande Initiale
    required: true
    elicit: false
    instructions: |
      Retranscrire fid√®lement la demande de l'utilisateur
    content: |
      {AI_GENERATE: Copier le prompt utilisateur exactement}

  - title: Reformulation
    required: true
    elicit: false
    instructions: |
      Reformuler de mani√®re claire et structur√©e
    content: |
      {AI_GENERATE: Reformuler la demande de fa√ßon professionnelle}

  - title: Objectif
    required: true
    elicit: true
    instructions: |
      Clarifier l'objectif principal
    content: |
      {AI_ELICIT: Demander "Quel est l'objectif principal de cette demande ?"}

  - title: Contexte
    required: true
    elicit: false
    instructions: |
      Contexte m√©tier ou utilisateur
    content: |
      {AI_GENERATE: Identifier le contexte depuis le prompt}

  - title: P√©rim√®tre
    required: true
    elicit: true
    instructions: |
      D√©finir ce qui est inclus et exclu
    content: |
      {AI_ELICIT: Demander "Qu'est-ce qui est IN et OUT scope ?"}

  - title: Prochaine √âtape
    required: true
    elicit: false
    content: |
      Ce brief sera analys√© par ProductMan pour cr√©er une user story fonctionnelle.
```

### 6. Template: `user-story-template.yaml`

**Emplacement**: `.speiros/templates/user-story-template.yaml`

```yaml
template:
  name: User Story Template
  id: user-story-template
  version: 1.0
  description: Template complet pour user stories (Product + Spec + Dev sections)

sections:
  # === SECTION PRODUCT (remplie par product-agent) ===
  - title: M√©tadonn√©es
    required: true
    elicit: false
    filled_by: product-agent
    content: |
      - **ID**: {story_id}
      - **Titre**: {story_title}
      - **Epic**: {epic_name}
      - **Statut**: Draft | Product-Ready | Spec-Ready | In-Progress | Done
      - **Priorit√©**: Critique | Haute | Moyenne | Basse
      - **Estimation**: {points}

  - title: Description
    required: true
    elicit: false
    filled_by: product-agent
    instructions: |
      Format: En tant que [qui], je veux [quoi], afin de [pourquoi]
    content: |
      {AI_GENERATE: Cr√©er une description user story classique}

  - title: Contexte Fonctionnel
    required: true
    elicit: false
    filled_by: product-agent
    instructions: |
      Contexte fonctionnel self-contained (r√©sum√© de product-context pertinent)
    content: |
      {AI_GENERATE: Synth√©tiser le contexte produit pertinent}

  - title: Cas d'Usage
    required: true
    elicit: true
    filled_by: product-agent
    content: |
      {AI_ELICIT: D√©crire les cas d'usage principaux}

  - title: Crit√®res d'Acceptation
    required: true
    elicit: true
    filled_by: product-agent
    content: |
      {AI_ELICIT: Lister les crit√®res d'acceptation fonctionnels}

  # === SECTION SPEC (remplie par spec-agent) ===
  - title: Analyse Technique
    required: true
    elicit: false
    filled_by: spec-agent
    instructions: |
      Analyse technique de la demande fonctionnelle
    content: |
      {AI_GENERATE: Analyser les implications techniques}

  - title: Contexte Technique
    required: true
    elicit: false
    filled_by: spec-agent
    instructions: |
      Contexte technique self-contained (r√©sum√© de technical-context pertinent)
    content: |
      {AI_GENERATE: Synth√©tiser le contexte technique pertinent}

  - title: Plan d'Impl√©mentation
    required: true
    elicit: true
    filled_by: spec-agent
    instructions: |
      Liste d√©taill√©e des t√¢ches d'impl√©mentation avec ordre et d√©tails
    content: |
      {AI_ELICIT: Cr√©er un plan d'impl√©mentation d√©taill√© t√¢che par t√¢che}

  - title: Fichiers √† Modifier/Cr√©er
    required: true
    elicit: false
    filled_by: spec-agent
    content: |
      {AI_GENERATE: Lister les fichiers impact√©s}

  - title: Points d'Attention
    required: true
    elicit: false
    filled_by: spec-agent
    content: |
      {AI_GENERATE: Identifier les risques et points d'attention}

  # === SECTION DEV (remplie par dev-agent) ===
  - title: R√©sultats d'Impl√©mentation
    required: true
    elicit: false
    filled_by: dev-agent
    instructions: |
      Documenter ce qui a √©t√© impl√©ment√©, fichiers modifi√©s, tests ajout√©s
    content: |
      {AI_GENERATE: Documenter l'impl√©mentation r√©alis√©e}

  - title: D√©cisions Techniques
    required: false
    elicit: false
    filled_by: dev-agent
    instructions: |
      Documenter les d√©cisions techniques prises durant l'impl√©mentation
    content: |
      {AI_GENERATE: Lister les d√©cisions et leur rationale}

  - title: Tests
    required: true
    elicit: false
    filled_by: dev-agent
    content: |
      {AI_GENERATE: Lister les tests ajout√©s et r√©sultats}
```

### 7. Template: `adr-entry-tmpl.yaml`

**Emplacement**: `.speiros/templates/adr-entry-tmpl.yaml`

```yaml
template:
  name: ADR Entry Template
  id: adr-entry-template
  version: 1.0
  description: Template pour documenter une d√©cision technique dans architecture-decision-records/

sections:
  - title: M√©tadonn√©es
    required: true
    elicit: false
    content: |
      - **Date**: {date}
      - **Story**: {story_id}
      - **Cat√©gorie**: {category}
      - **Impact**: Faible | Moyen | √âlev√©

  - title: D√©cision
    required: true
    elicit: false
    instructions: |
      D√©crire la d√©cision technique prise
    content: |
      {AI_GENERATE: D√©crire la d√©cision en une phrase}

  - title: Contexte
    required: true
    elicit: false
    instructions: |
      Pourquoi cette d√©cision √©tait n√©cessaire
    content: |
      {AI_GENERATE: Expliquer le contexte}

  - title: Options Consid√©r√©es
    required: false
    elicit: false
    content: |
      {AI_GENERATE: Lister les alternatives consid√©r√©es}

  - title: Rationale
    required: true
    elicit: false
    instructions: |
      Pourquoi cette option a √©t√© choisie
    content: |
      {AI_GENERATE: Expliquer le raisonnement}

  - title: Cons√©quences
    required: true
    elicit: false
    content: |
      {AI_GENERATE: Lister les cons√©quences techniques}

  - title: R√©f√©rences
    required: false
    elicit: false
    content: |
      - **Story**: {story_link}
      - **Code**: {code_files}
      - **Documentation**: {docs_links}
```

## Plan d'Impl√©mentation - TODO LIST

### PHASE 1: Setup et Structure de Base

- [ ] **T1.1** - Cr√©er le dossier `.speiros/workflows/` s'il n'existe pas
- [ ] **T1.2** - Cr√©er le dossier `.speiros/agents/` s'il n'existe pas
- [ ] **T1.3** - Cr√©er le dossier `.speiros/templates/` s'il n'existe pas
- [ ] **T1.4** - Cr√©er le dossier `.speiros/tasks/speiros-workflow/` s'il n'existe pas

### PHASE 2: Cr√©ation du Workflow Principal

- [ ] **T2.1** - Cr√©er le fichier `.speiros/workflows/speiros-workflow.yaml`
- [ ] **T2.2** - Ajouter les m√©tadonn√©es du workflow (name, id, description, whenToUse)
- [ ] **T2.3** - D√©finir la section `prerequisites` (product-context/ et technical-context/)
- [ ] **T2.4** - Cr√©er la section `phases` avec les 3 phases (Product, Spec, Dev)
- [ ] **T2.5** - Cr√©er la section `sequence` et ajouter le Step 1 (create-brief) - Phase Product
- [ ] **T2.6** - Ajouter le Step 2 (fetch-product-context) - Phase Product
- [ ] **T2.7** - Ajouter le Step 3 (create-functional-story) avec handoff ‚Üí spec-agent - Phase Product
- [ ] **T2.8** - Ajouter le Step 4 (analyse-functional-story) - Phase Spec
- [ ] **T2.9** - Ajouter le Step 5 (fetch-technical-context) - Phase Spec
- [ ] **T2.10** - Ajouter le Step 6 (create-technical-story) avec handoff ‚Üí dev-agent - Phase Spec
- [ ] **T2.11** - Ajouter le Step 7 (implement-user-story) - Phase Dev
- [ ] **T2.12** - Ajouter le Step 8 (update-adr) - Phase Dev
- [ ] **T2.13** - Ajouter la section `artifacts` (created, used)
- [ ] **T2.14** - Ajouter la section `workflow_properties`
- [ ] **T2.15** - Valider que le YAML est syntaxiquement correct

### PHASE 3: Cr√©ation des Templates

- [ ] **T3.1** - Cr√©er le fichier `.speiros/templates/brief-tmpl.yaml`
- [ ] **T3.2** - Ajouter les m√©tadonn√©es du template brief (name, id, version, description)
- [ ] **T3.3** - Cr√©er la section "M√©tadonn√©es" du brief
- [ ] **T3.4** - Cr√©er la section "Demande Initiale" du brief
- [ ] **T3.5** - Cr√©er la section "Reformulation" du brief
- [ ] **T3.6** - Cr√©er la section "Objectif" du brief (elicit: true)
- [ ] **T3.7** - Cr√©er la section "Contexte" du brief
- [ ] **T3.8** - Cr√©er la section "P√©rim√®tre" du brief (elicit: true)
- [ ] **T3.9** - Cr√©er la section "Prochaine √âtape" du brief
- [ ] **T3.10** - Valider que le YAML brief-tmpl.yaml est correct

- [ ] **T3.11** - Cr√©er le fichier `.speiros/templates/user-story-template.yaml`
- [ ] **T3.12** - Ajouter les m√©tadonn√©es du template user story
- [ ] **T3.13** - Cr√©er la section "M√©tadonn√©es" (filled_by: product-agent)
- [ ] **T3.14** - Cr√©er la section "Description" (filled_by: product-agent)
- [ ] **T3.15** - Cr√©er la section "Contexte Fonctionnel" (filled_by: product-agent)
- [ ] **T3.16** - Cr√©er la section "Cas d'Usage" (filled_by: product-agent, elicit: true)
- [ ] **T3.17** - Cr√©er la section "Crit√®res d'Acceptation" (filled_by: product-agent, elicit: true)
- [ ] **T3.18** - Cr√©er la section "Analyse Technique" (filled_by: spec-agent)
- [ ] **T3.19** - Cr√©er la section "Contexte Technique" (filled_by: spec-agent)
- [ ] **T3.20** - Cr√©er la section "Plan d'Impl√©mentation" (filled_by: spec-agent, elicit: true)
- [ ] **T3.21** - Cr√©er la section "Fichiers √† Modifier/Cr√©er" (filled_by: spec-agent)
- [ ] **T3.22** - Cr√©er la section "Points d'Attention" (filled_by: spec-agent)
- [ ] **T3.23** - Cr√©er la section "R√©sultats d'Impl√©mentation" (filled_by: dev-agent)
- [ ] **T3.24** - Cr√©er la section "D√©cisions Techniques" (filled_by: dev-agent)
- [ ] **T3.25** - Cr√©er la section "Tests" (filled_by: dev-agent)
- [ ] **T3.26** - Valider que le YAML user-story-template.yaml est correct

- [ ] **T3.27** - Cr√©er le fichier `.speiros/templates/adr-entry-tmpl.yaml`
- [ ] **T3.28** - Ajouter les m√©tadonn√©es du template ADR
- [ ] **T3.29** - Cr√©er la section "M√©tadonn√©es" du ADR
- [ ] **T3.30** - Cr√©er la section "D√©cision" du ADR
- [ ] **T3.31** - Cr√©er la section "Contexte" du ADR
- [ ] **T3.32** - Cr√©er la section "Options Consid√©r√©es" du ADR
- [ ] **T3.33** - Cr√©er la section "Rationale" du ADR
- [ ] **T3.34** - Cr√©er la section "Cons√©quences" du ADR
- [ ] **T3.35** - Cr√©er la section "R√©f√©rences" du ADR
- [ ] **T3.36** - Valider que le YAML adr-entry-tmpl.yaml est correct

### PHASE 4: Cr√©ation des Agents

- [ ] **T4.1** - Cr√©er le fichier `.speiros/agents/product-agent.md`
- [ ] **T4.2** - Ajouter le bloc YAML avec `activation-instructions` pour product-agent
- [ ] **T4.3** - D√©finir la section `agent` (name: ProductMan, id, title, icon, whenToUse)
- [ ] **T4.4** - D√©finir la section `persona` (role, style, identity, focus, core_principles)
- [ ] **T4.5** - D√©finir la section `commands` (help, create-brief, fetch-context, create-story, run-workflow, validate, status, exit)
- [ ] **T4.6** - D√©finir la section `dependencies` (workflows, tasks, templates, context_folders)
- [ ] **T4.7** - Valider que product-agent.md est complet et coh√©rent

- [ ] **T4.8** - Cr√©er le fichier `.speiros/agents/spec-agent.md`
- [ ] **T4.9** - Ajouter le bloc YAML avec `activation-instructions` pour spec-agent
- [ ] **T4.10** - D√©finir la section `agent` (name: SpecMan, id, title, icon, whenToUse)
- [ ] **T4.11** - D√©finir la section `persona` (role, style, identity, focus, core_principles)
- [ ] **T4.12** - D√©finir la section `commands` (help, analyse, fetch-technical, create-spec, run-workflow, validate, status, exit)
- [ ] **T4.13** - D√©finir la section `dependencies` (workflows, tasks, templates, context_folders)
- [ ] **T4.14** - Valider que spec-agent.md est complet et coh√©rent

- [ ] **T4.15** - Cr√©er le fichier `.speiros/agents/dev-agent.md`
- [ ] **T4.16** - Ajouter le bloc YAML avec `activation-instructions` pour dev-agent
- [ ] **T4.17** - D√©finir la section `agent` (name: DevMan, id, title, icon, whenToUse)
- [ ] **T4.18** - D√©finir la section `persona` (role, style, identity, focus, core_principles)
- [ ] **T4.19** - D√©finir la section `commands` (help, implement, update-adr, run-workflow, test, status, exit)
- [ ] **T4.20** - D√©finir la section `dependencies` (workflows, tasks, templates, context_folders)
- [ ] **T4.21** - Valider que dev-agent.md est complet et coh√©rent

### PHASE 5: V√©rification de Coh√©rence avec les Tasks

- [ ] **T5.1** - V√©rifier que le fichier `.speiros/tasks/speiros-workflow/create-brief.md` existe
- [ ] **T5.2** - V√©rifier que le fichier `.speiros/tasks/speiros-workflow/fetch-product-context.md` existe
- [ ] **T5.3** - V√©rifier que le fichier `.speiros/tasks/speiros-workflow/create-functional-story.md` existe
- [ ] **T5.4** - V√©rifier que le fichier `.speiros/tasks/speiros-workflow/analyse-functional-story.md` existe
- [ ] **T5.5** - V√©rifier que le fichier `.speiros/tasks/speiros-workflow/fetch-technical-context.md` existe
- [ ] **T5.6** - V√©rifier que le fichier `.speiros/tasks/speiros-workflow/create-technical-story.md` existe
- [ ] **T5.7** - V√©rifier que le fichier `.speiros/tasks/speiros-workflow/implement-user-story.md` existe
- [ ] **T5.8** - V√©rifier que le fichier `.speiros/tasks/speiros-workflow/update-adr.md` existe
- [ ] **T5.9** - Valider que les 8 tasks sont r√©f√©renc√©es correctement dans le workflow
- [ ] **T5.10** - Valider que chaque agent r√©f√©rence les bonnes tasks dans ses dependencies

### PHASE 6: Documentation

- [ ] **T6.1** - Cr√©er le fichier `.speiros/README.md`
- [ ] **T6.2** - Ajouter une introduction g√©n√©rale √† Speiros
- [ ] **T6.3** - Documenter le concept "Self-Contained Handoffs"
- [ ] **T6.4** - Ajouter le diagramme de s√©quence (mermaid) des 3 phases
- [ ] **T6.5** - Documenter le flow complet Brief ‚Üí Code avec exemples
- [ ] **T6.6** - Expliquer le r√¥le de chaque agent (ProductMan, SpecMan, DevMan)
- [ ] **T6.7** - Documenter la structure des fichiers cr√©√©s (roadmap/, briefs/, user-stories/, architecture-decision-records/)
- [ ] **T6.8** - Ajouter des exemples concrets d'ex√©cution du workflow
- [ ] **T6.9** - Documenter les pr√©requis (product-context/ et technical-context/ peupl√©s)
- [ ] **T6.10** - Ajouter une section "Comment d√©marrer" avec commandes d'activation

### PHASE 7: Tests et Validation

- [ ] **T7.1** - Valider syntaxe YAML de `speiros-workflow.yaml` avec `npx js-yaml`
- [ ] **T7.2** - Valider syntaxe YAML de `brief-tmpl.yaml` avec `npx js-yaml`
- [ ] **T7.3** - Valider syntaxe YAML de `user-story-template.yaml` avec `npx js-yaml`
- [ ] **T7.4** - Valider syntaxe YAML de `adr-entry-tmpl.yaml` avec `npx js-yaml`
- [ ] **T7.5** - Tester l'activation de `@product-agent` et v√©rifier `*help`
- [ ] **T7.6** - Tester l'activation de `@spec-agent` et v√©rifier `*help`
- [ ] **T7.7** - Tester l'activation de `@dev-agent` et v√©rifier `*help`
- [ ] **T7.8** - Test end-to-end: Ex√©cuter `@product-agent *run-workflow` avec un brief exemple
- [ ] **T7.9** - Test end-to-end: Continuer avec `@spec-agent *run-workflow`
- [ ] **T7.10** - Test end-to-end: Terminer avec `@dev-agent *run-workflow`
- [ ] **T7.11** - V√©rifier que tous les artefacts ont √©t√© cr√©√©s (brief, story, code, ADRs)
- [ ] **T7.12** - Valider la coh√©rence avec US-2.1 (product-context/)
- [ ] **T7.13** - Valider la coh√©rence avec US-2.2 (technical-context/)

### Crit√®res de Validation Globaux

**Tous les items suivants doivent √™tre ‚úÖ avant de marquer la story "Done"**:

- [ ] ‚úÖ Workflow `speiros-workflow.yaml` existe et contient 8 √©tapes en 3 phases
- [ ] ‚úÖ Handoffs explicites document√©s (phase 1‚Üí2, 2‚Üí3)
- [ ] ‚úÖ Prerequisites clairement d√©finis dans le workflow
- [ ] ‚úÖ Self-contained handoffs document√©s
- [ ] ‚úÖ Tous les YAMLs sont syntaxiquement valides
- [ ] ‚úÖ Agent `product-agent.md` cr√©√© et activable via `@product-agent`
- [ ] ‚úÖ Agent `spec-agent.md` cr√©√© et activable via `@spec-agent`
- [ ] ‚úÖ Agent `dev-agent.md` cr√©√© et activable via `@dev-agent`
- [ ] ‚úÖ Chaque agent a ses tasks (ProductMan: 3, SpecMan: 3, DevMan: 2)
- [ ] ‚úÖ D√©pendances vers les bons templates et contexts configur√©es
- [ ] ‚úÖ Commandes mapp√©es aux phases du workflow
- [ ] ‚úÖ Template `brief-tmpl.yaml` cr√©√© avec 6 sections
- [ ] ‚úÖ Template `user-story-template.yaml` cr√©√© avec 13 sections group√©es par agent
- [ ] ‚úÖ Template `adr-entry-tmpl.yaml` cr√©√© avec 6 sections ADR-style
- [ ] ‚úÖ Sections `filled_by` clairement assign√©es dans les templates
- [ ] ‚úÖ Les 8 tasks existent dans `.speiros/tasks/speiros-workflow/`
- [ ] ‚úÖ R√©f√©rences exactes dans le workflow et les agents
- [ ] ‚úÖ README `.speiros/README.md` cr√©√© avec vision globale de Speiros
- [ ] ‚úÖ Diagramme de s√©quence des 3 phases pr√©sent
- [ ] ‚úÖ Exemples concrets d'ex√©cution document√©s
- [ ] ‚úÖ Explication des handoffs document√©e
- [ ] ‚úÖ Test end-to-end r√©ussi (brief ‚Üí code ‚Üí ADRs)
- [ ] ‚úÖ Coh√©rence totale avec US-2.1 et US-2.2

## Tests et Validation

### Test 1: Workflow complet end-to-end

```bash
# Phase 1
@product-agent *run-workflow
# Input: "Je veux ajouter un syst√®me de notifications en temps r√©el"

# Phase 2
@spec-agent *run-workflow
# Input: story cr√©√©e par product-agent

# Phase 3
@dev-agent *run-workflow
# Input: story enrichie par spec-agent
```

**R√©sultat attendu**: Code impl√©ment√© + ADRs mis √† jour

### Test 2: V√©rification des templates

```bash
@product-agent *create-brief
# V√©rifier que brief-tmpl.yaml se charge
```

### Test 3: Validation YAML

```bash
npx js-yaml .speiros/workflows/speiros-workflow.yaml
npx js-yaml .speiros/templates/*.yaml
```

### Test 4: Activation des agents

```bash
@product-agent *help
@spec-agent *help
@dev-agent *help
```

## D√©finition de "Termin√©" (DoD)

- [ ] Workflow `speiros-workflow.yaml` cr√©√© avec 8 √©tapes et 3 phases
- [ ] Agent `product-agent.md` cr√©√© et activable
- [ ] Agent `spec-agent.md` cr√©√© et activable
- [ ] Agent `dev-agent.md` cr√©√© et activable
- [ ] Template `brief-tmpl.yaml` cr√©√© (6 sections)
- [ ] Template `user-story-template.yaml` cr√©√© (13 sections)
- [ ] Template `adr-entry-tmpl.yaml` cr√©√© (6 sections)
- [ ] Les 8 tasks existent dans `.speiros/tasks/speiros-workflow/`
- [ ] README `.speiros/README.md` cr√©√© avec documentation compl√®te
- [ ] Test end-to-end r√©ussi (brief ‚Üí code)
- [ ] Coh√©rence totale avec US-2.1 et US-2.2

## Notes Techniques

### Diagramme de S√©quence du Workflow

```mermaid
sequenceDiagram
    actor User
    participant PA as ProductMan
    participant PC as product-context/
    participant SA as SpecMan
    participant TC as technical-context/
    participant DA as DevMan
    participant ADR as architecture-decision-records/

    User->>PA: Brief: "Add notifications"
    PA->>PA: create-brief (brief-tmpl.yaml)
    PA->>PC: fetch-product-context
    PC-->>PA: Relevant product context
    PA->>PA: create-functional-story
    PA->>User: Elicit: Acceptance criteria?
    User-->>PA: Criteria provided
    PA->>SA: Handoff: story (Product section)

    SA->>SA: analyse-functional-story
    SA->>TC: fetch-technical-context
    TC-->>SA: Relevant technical context
    SA->>SA: create-technical-story
    SA->>User: Elicit: Implementation plan OK?
    User-->>SA: Approved
    SA->>DA: Handoff: story (Product + Spec sections)

    DA->>DA: implement-user-story
    DA->>DA: Code + Tests
    DA->>ADR: update-adr (adr-entry-tmpl.yaml)
    DA->>User: Story completed ‚úÖ
```

### Concept Self-Contained

**Principe cl√©**: Chaque handoff doit √™tre auto-suffisant.

- **ProductMan ‚Üí SpecMan**: La section Product contient TOUT le contexte fonctionnel (pas de lien vers product-context/)
- **SpecMan ‚Üí DevMan**: La section Implementation Plan contient TOUT le plan technique (pas de lien vers technical-context/)
- **Avantage**: DevMan peut impl√©menter sans consulter aucun contexte externe

### Structure des Fichiers Cr√©√©s

```
# FICHIERS INTERM√âDIAIRES (artifacts de workflow)
.speiros/context-engineering/speiros-workflow-artifacts/
‚îú‚îÄ‚îÄ briefs/
‚îÇ   ‚îî‚îÄ‚îÄ brief-001-product-context.md
‚îî‚îÄ‚îÄ user-stories/
    ‚îú‚îÄ‚îÄ story-001-analysis.md
    ‚îî‚îÄ‚îÄ story-001-technical-context.md

# FICHIERS FINAUX (livrables de r√©f√©rence)
roadmap/
‚îú‚îÄ‚îÄ briefs/
‚îÇ   ‚îî‚îÄ‚îÄ brief-001-notifications.md
‚îî‚îÄ‚îÄ user-stories/
    ‚îî‚îÄ‚îÄ story-001-notifications.md (3 sections: Product + Spec + Dev)

context/architecture-decision-records/
‚îî‚îÄ‚îÄ TECHNICAL-CHOICE.md (nouvelles entr√©es)
```

## Risques et Mitigation

| Risque                      | Impact | Probabilit√© | Mitigation                                              |
| --------------------------- | ------ | ----------- | ------------------------------------------------------- |
| Handoffs non self-contained | √âlev√©  | Moyen       | Validation stricte, templates avec instructions claires |
| Contexte non peupl√©         | √âlev√©  | Moyen       | V√©rification au d√©marrage de chaque agent               |
| Workflow trop long          | Moyen  | Faible      | Mode `*run-workflow` pour automatiser                   |
| √âlicitations ignor√©es       | Moyen  | Moyen       | Templates avec `elicit: true` obligatoire               |
| Tasks manquantes            | √âlev√©  | Faible      | V√©rification T√¢che 4                                    |

## D√©pendances

- US-2.1 complet√© (product-context/ peupl√©)
- US-2.2 complet√© (technical-context/ peupl√©)
- `.speiros/tasks/speiros-workflow/*.md` (8 fichiers)
- M√©thodologie BMAD (workflow, agent, task, template)

## √âvolutions Futures

- Mode batch pour traiter plusieurs briefs
- Workflow parall√®le pour features ind√©pendantes
- Int√©gration CI/CD (d√©ploiement auto apr√®s Story Done)
- Dashboard de suivi des stories
- Metrics (v√©locit√©, qualit√©, time to implement)
- Export stories en format externe (Jira, Linear, etc.)
